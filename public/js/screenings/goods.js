define(function(require){require("jquery");var a=(require("../config"),require("../libs/utils"));require("../libs/jquery.waterfall"),require("../libs/jquery.ellipsis");var t=require("../libs/tab");$(document).ready(function(){function e(a){return parseFloat(a)/100%1!=0?parseFloat(a)/100:parseFloat(a)/100+".00"}function i(t){return a.SendAjax({url:"/screenings/goods",param:t,tipText:"获取套餐列表",callback:function(a){var t=a,i="";if(t.success){var s=t.data.data;d=t.data.pageCount,$.each(s,function(a,t){var s="",l="",r="";t.productKeyAttributeList&&t.productKeyAttributeList.forEach(function(a,t){"fit_people"==a.attributeName&&(s=a.value)}),l=e(t.discountPrice),r=e(t.price),i+='<li class="box" style="opacity:0;filter:alpha(opacity=0);"><a href="/screenings/goods/detail/'+t.id+'"><img src="'+t.goodsImages[0].imageUrl+'"/><h4>'+t.goodsName+"</h4></a><p>"+s+'</p><div class="price"><span class="new"><em>￥</em>'+l+'</span><span class="old">原价'+r+"</span></div></div></li>"}),d>=o&&(o+=1,$(i).appendTo($("#waterfal")))}}}),{pageCount:d,data:t}}function s(){var a={pageIndex:o,send:!0,categoryId:$(".tab ul li.on").attr("data-id")},t="";d?d>=o&&i(a):t=i(a)}require("../imgAuto"),t(".tab li");var l=$(".tab"),r=l.find(".on").attr("data-id"),n=l.find("img");$.each(n,function(a,t){r==$(t).attr("data-id")&&$(t).show()}),a.browser.ie?$(".ellips").ellipsis({row:2,"char":"……",callback:function(){}}):$(".ellips").ellipsis({row:1,"char":"……",callback:function(){}}),$(".pages").on("click",".prev,.next",function(){var t=$(this).attr("data-page"),e=$(this),i={pageIndex:t};e.hasClass("disable")||a.SendAjax({url:"/healths/list/list_ask_web",param:i,method:"POST",tipText:"请求问答数据",callback:function(a){var t=a;console.log("json:",t);var i=$("#list_ask ul");if(t.success){var s=t.data.data,l="",r=t.data.currentPage,n=t.data.pageCount;$.each(s,function(a,t){l+='<li><a href="/healths/list/article/'+t.id+'" title="'+t.title+'"><i class="icon"></i>'+t.title+"</a></li>"}),e.hasClass("next")?r==n?(e.addClass("disable"),e.siblings().removeClass("disable")):1!=r?(e.attr("data-page",r+1),e.siblings().removeClass("disable").attr("data-page",r-1)):(e.attr("data-page",r+1),e.siblings().attr("data-page",r-1)):1==r?(e.addClass("disable"),e.siblings().removeClass("disable")):1!=r?(e.attr("data-page",r-1),e.siblings().removeClass("disable").attr("data-page",r+1)):(e.attr("data-page",r-1),e.siblings().attr("data-page",r+1)),i.html(l)}}})});var o=2,d="";s();var c=$(document).height(),p=$(".footer").outerHeight()+$(".copyright").outerHeight();$(window).scroll(function(){var a=$(document).scrollTop();a>=c-p&&s()})})});