define(function(require,exports,module){function t(t,i){var t=t||"";e.SendAjax({url:"/dic/list/typeAndLevel",param:{type:"district",level:"2",activeState:"1"},method:"GET",tipText:"获取城市",callback:function(e){for(var n=e.data,a="",r=$("#choosed-city-id").val(),s=0;s<n.length;s++){var l=n[s];a+=n[s].id==r?'<a href="javascript:;" class="city on">'+l.name+"</a>":'<a href="javascript:;" class="city">'+l.name+"</a>"}$(".city-list").html(a);for(var c=$(".city-list .city"),s=0;s<n.length;s++)c.eq(s).data("city",n[s]).on("click",function(){o($(this))});i&&(newArr=n.filter(function(o){return o.name==t}),i&&i(newArr))},errorFun:function(t){}})}function o(t){var o=t.hasClass&&t.hasClass("city")&&t.data("city")||t;e.SendAjax({url:"/changeCity",param:{city:o},method:"GET",tipText:"切换城市",callback:function(t){window.location.reload()},errorFun:function(t){}})}require("jquery"),require("lazyload"),require("./login");var e=require("./libs/utils.js"),i=require("swiper"),n=require("./libs/BMap.js");require("cookie"),$(function(){function a(){function e(e){return s=e.name,i.setCenter(s),$.cookie("locals_city")||t(s,function(t){var e=$.cookie("locals_city");!e&&t.length&&o(t[0]),t.length&&$.cookie("locals_city",t[0].parentId,{path:"/"})}),s}var i=new n.Map("choosed-city-id"),a=new n.Point(116.331398,39.897445);i.centerAndZoom(a,12);var r=new n.LocalCity,s=r.get(e)}$("body");$.cookie("locals_city")||e.browser.ie?e.browser.ie&&alert("IE"):a();var r=window.location,s=r.pathname,l=$(".nav li a"),c="";e.BuildSelect($(".select-box")),$.each(l,function(t,o){c=$(o).attr("href"),-1!=s.search(c)&&$(o).parent().addClass("on").siblings().removeClass("on"),"/treat/regsource/list"==c&&"/treat/reg/doctorView"==s&&$(o).parent().addClass("on").siblings().removeClass("on")}),$(".city-name").hover(function(o){var e=$(this),i=e.find(".choose-city");i.stop(!1,!0).slideDown();var n=i.data("load");"first"===n&&(t(),i.data("load","non-first"))},function(t){t.stopPropagation();var o=$(this),e=o.find(".choose-city");e.stop(!1,!0).slideUp()}),$("section img").lazyload({effect:"fadeIn"});var d=$(window).height();$gotoTop=$(".gotoTop"),$gotoTop.click(function(){$("body,html").animate({scrollTop:0},600)}),$(window).scroll(function(){var t=$(window).scrollTop();t>d/2?$gotoTop.show():$gotoTop.fadeOut(700)});var p=$(window).width(),f=$(".nav").find(".wrapper");if(768>p){f.addClass("swiper-container");new i(".swiper-container",{nextButton:".swiper-button-next",prevButton:".swiper-button-prev",slidesPerView:4})}else f.removeClass().addClass("wrapper"),f.find("li").removeAttr("style");$(window).resize(function(){if(p=$(window).width(),768>p){f.addClass("swiper-container");new i(".swiper-container",{nextButton:".swiper-button-next",prevButton:".swiper-button-prev",slidesPerView:4})}else f.removeClass().addClass("wrapper"),f.find(".swiper-slide").addClass("3333333333333").removeAttr("style")})});var a=$(".nav_toggle"),r=$(".left-nav");a.click(function(){r.slideToggle(),$(this).parents("aside").toggleClass("active")});var s=$(".topBar_info aside");if($(".wapUser").click(function(){var t=$.cookie("accountId");t?s.slideToggle():window.location.href="/login"}),e.browser.ios){var l=$(".footerWap");$("input").focus(function(){var t=this,o=$(window).height()-l.height(),e=$(document).height()-l.height();e=e>o?e:o,setTimeout(function(){var i=$(window).scrollTop(),n=$(t).offset().top-i,a=$(t).offset().top+n;a=a>e?e:a,l.css({position:"absolute",top:o}),$(window).bind("scroll",function(){if(n!=o){var t=$(this).scrollTop()-i;afterScrollTopPos=o+t,l.css({position:"absolute",top:afterScrollTopPos})}})},100)}).blur(function(){$(".div-input").removeAttr("style"),$(window).unbind("scroll")})}});