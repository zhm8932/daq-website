define(function(require,exports,module){function a(a,t){d.CheckLogin(function(){var n=$("#order-detail").data("id");c.SendAjax({url:"/trade/pay/payid",param:{orderId:n},method:"POST",tipText:"获取支付ID",callback:function(n){a&&a(n.data.id,t)},errorFun:function(a){}})})}function t(a,t){var n=$("#order-detail").data("id"),i=window.location.href,e=i.substr(0,i.indexOf("/",i.indexOf("/",i.indexOf("/")+1)+1));console.log(e),d.CheckLogin(function(){c.SendAjax({url:"/trade/order/pay",param:{id:a,payWay:t,ext:e+"/trade/order/paySuccess?order_no="+n},method:"POST",tipText:"前往支付页面",callback:function(a){window.location.href=a.data.credentia.order_info},errorFun:function(a){}})})}function n(a,t){d.CheckLogin(function(){c.SendAjax({url:"/trade/order/pay",param:{id:a,payWay:t},method:"POST",tipText:"前往支付页面",callback:function(a){var t="true"===$("#isMobile").val();t?i(a):e(a)},errorFun:function(a){}})})}function i(a){var t=null;new c.Popup({msg:'<div class="wechat-pay-dialog"><div class="left-box"><img src="data:image/png;base64,'+a.data.credentia.orderInfo+'"/><div class="wechat-tip"><i class="icon scan"></i><span class="scan-tip">请使用微信"扫一扫"扫描二维码支付</span></div><div class="price text-stress">￥'+a.data.tradeDTO.amount/100+"</div></div><div>",otherMsg:"",bOhterMsg:!0,callback:function(){t=setInterval(function(){o()},3e3)},okText:"登录",width:"300",otherBox:"wechat-box",isHide:!1,okCallback:function(){},cancelFun:function(){clearInterval(t)}})}function e(a){var t=null;new c.Popup({msg:'<div class="wechat-pay-dialog"><div class="left-box"><img src="data:image/png;base64,'+a.data.credentia.orderInfo+'"/><div class="wechat-tip"><i class="icon scan"></i><span class="scan-tip">请使用微信"扫一扫"扫描二维码支付</span></div><div class="price text-stress">￥'+(a.data.tradeDTO.amount/100).toFixed(2)+'</div></div><div class="right-box"><img src="/images/wxsm_img.png"/></div><div>',otherMsg:"",bOhterMsg:!0,callback:function(){t=setInterval(function(){o()},3e3)},okText:"登录",width:"730",otherBox:"wechat-box",isHide:!1,okCallback:function(){},cancelFun:function(){clearInterval(t)}})}function o(){d.CheckLogin(function(){var a=$("#order-detail").data("id");c.SendAjax({url:"/trade/order/state",param:{id:a},method:"GET",tipText:"前往支付页面",callback:function(t){1!=t.data.orderState&&(window.location.href="/trade/order/paySuccess?order_no="+a)},errorFun:function(a){}})})}var c=require("../libs/utils.js"),r=require("../libs/timer.js"),d=require("../login"),s=window.location.href,l=s.substr(0,s.indexOf("/",s.indexOf("/",s.indexOf("/")+1)+1));console.log(l),$(function(){r.updateTime({totalTime:18e5,outdatedFun:function(){window.location.href="/trade/order/list"}})}),$(".alipay").on("click",function(){var n=$(this).attr("data-paynum");a(t,n)}),$(".wechat-pay").on("click",function(){a(n,6)})});