define(function(require,exports,module){function e(a){a.off("click"),i.CheckLogin(function(){var l=$("#scheduleId").val(),i={scheduleId:l};o.SendAjax({url:"/treats/reg/byDoc",param:i,method:"POST",tipText:"挂号",callback:function(e){var a=e.data.needPay;a?window.location.href="/treats/reg/topay?reservationId="+e.data.id:window.location.href="/users/register/list"},errorFun:function(l){a.on("click",function(){e($(this))})}})})}function a(){var e=new o.Popup({msg:'<div class="box-header">完善信息<i class="icon close closePopup"></i></div><div class="box-body"><ul class="tip-box"><li>为了能正常使用预约挂号服务,请及时补充以下材料。</li><li>以下信息为预约时所需项,一经填写不可更改,提交前请检查核对。</li><li>绑定已有客户编号,您可在病例中心中查看历史报告。</li></ul><form name="accInfoForm"><ul class="info-box"><li><label><i class="text-stress">* </i>姓名</label><input name="name"/></li><li><label><i class="text-stress">* </i>性别</label><div id="gender" class="select-box none"><div class="selected"><span class="text"><span class="text-sec">请选择</span></span><i class="icon pull-down"></i></div><ul class="options"><li class="option" data-value="1">男</li><li class="option" data-value="2">女</li></ul></div></li><li><label><i class="text-stress">* </i>出生年月</label><input id="birthday" name="birthday" readonly/></li><li><label>绑定已有客户编码</label><input name="patientCode" placeholder="请输入已有客户编码"/></li><span class="prompt"><i class="icon"></i><em>客户编码有误</em></span></ul></form></div>',otherMsg:"confirm-btn",popupBox:"popupBox",okText:"提交",cancel:"closePopup",otherBox:"complete-dialog",width:"475",isHide:!1,cancelFun:function(){window.location.href="/treat/regsource/list"},okCallback:function(){l(e)}})}function l(e){var a=$(".complete-dialog"),i=a.find("[name=name]").val().trim(),t=a.find("[name=birthday]").val().trim(),s=a.find("#gender .option.active").attr("data-value");if(!(i&&t&&s))return a.find(".prompt em").html("必输项不能为空"),a.find(".prompt").show(),!1;var n=$(".complete-dialog span.ok");n.addClass("disabled").off("click");var c=$("form[name=accInfoForm]").serialize()+"&gender="+s;o.SendAjax({url:"/users/account/complete",param:c,method:"POST",tipText:"完善信息",callback:function(a){var l=new o.MsgShow({delayTime:2e3,title:'<i class="icon"></i>完善成功!',otherBox:"successBox"});e.hideBox(),l.hideMsg(1e3)},errorFun:function(o){o.data&&(a.find(".prompt em").html("客户编码有误"),a.find(".prompt").show()),n.removeClass("disabled").on("click",function(){l(e)})}})}console.log("进入了");var o=require("../libs/utils.js");console.log("引入1");var i=require("../login.js");console.log("引入2"),require("moment"),console.log("引入3"),require("daterangepicker"),console.log("DOM加载完成执行了"),$("#scheduleId-select .option").click(function(){var a=$(this);$("#scheduleId").val(a.data("value"));var l=parseFloat(a.data("cost"));$("#cost").html((l/100).toFixed(2)+"元");var o=$("#scheduleId-select");"first"==o.attr("data-load")&&(o.attr("data-load","non-first"),$("#commit-reg").removeClass("disabled").off("click").on("click",function(){e($(this))}))});var t=$("#hasBind").val();"true"!=t&&(a({}),$("#birthday").daterangepicker({singleDatePicker:!0,showDropdowns:!0,autoUpdateInput:!1,locale:{format:"YYYY-MM-DD",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}},function(e,a,l){$("#birthday").val(e.format("YYYY-MM-DD"))}))});