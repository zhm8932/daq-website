!function(t){"function"==typeof define&&define.amd&&define(["jquery"],t),"function"==typeof define?define(["jquery"],function(){return t(window.jQuery,void 0)}):t(window.jQuery||window.Zepto)}(function(t,e){window.touchSlider=function(n){function i(t){T.removeClass(n.currentClass).eq(t).addClass(n.currentClass)}function o(t,n){var i=p.current;i!==t&&(t=t!==e?t:i+1,C.to(t,{complete:n}))}function r(t){C.to(p.current+1,{dirX:1,complete:t})}function a(t){C.to(p.current-1,{dirX:-1,complete:t})}function u(){E&&s()}function s(){return E=!0,X||(clearTimeout(W),W=setTimeout(function(){C.moving||X||r()},n.delay)),n.container}function c(){return clearTimeout(W),E=!1,n.container}function h(){var e,n,i,o,r,a,u,s,c,h,l,d,p,M=t(document),x=!1,T=function(t){if(!(t.which>1)){if(x&&M.triggerHandler(b+"."+f),x=!0,n=!1,e=t.timeStamp,u=d=0,i=[0,0,0,e],t.originalEvent.touches)return void M.one(g,q);t.preventDefault(),r=a=t.pageX,h=l=t.pageY,c=y[0].offsetLeft,o=[0,0,0,r],M.bind(v,S),M.one(b+"."+f,W),C.moveStart(t)}},q=function(t){1===t.originalEvent.touches.length&&(r=a=t.pageX=t.originalEvent.touches[0].pageX,h=l=t.pageY=t.originalEvent.touches[0].pageY,s=p=0,c=new WebKitCSSMatrix(window.getComputedStyle(y[0]).webkitTransform).e,o=[0,0,0,r],M.bind(v,S),M.one(b,W),C.moveStart(t))},S=function(t){var e,r;if(t.originalEvent.touches&&m){if(1!==t.originalEvent.touches.length)return;if(e=t.pageX=t.originalEvent.touches[0].pageX,r=t.pageY=t.originalEvent.touches[0].pageY,s+=Math.abs(e-a),p+=Math.abs(r-l),Math.abs(s-p)>50){var c=s;s=Math.min(100,Math.max(0,s-p)),p=Math.min(100,Math.max(0,p-c))}if(e===a)return;n||(s>p?(t.preventDefault(),n=!0):W(t))}else{if(e=t.pageX,r=t.pageY,e===a)return;/msie/.test(navigator.userAgent.toLowerCase())&&t.preventDefault()}u+=Math.abs(e-a),d+=Math.abs(r-l),i.shift(),i.push(t.timeStamp),o.shift(),o.push(e),C.move(t,a),a=e,l=r},W=function(t){x=!1,t.originalEvent&&!t.originalEvent.touches||(t.pageX=a,t.pageY=l),M.unbind(v,S);for(var n=i.length,r=0,s=0;--n>0;)if(i[n-1]){var c=o[n]-o[n-1];r+=Math.abs(c)/(i[n]-i[n-1]),0!==c&&(s=c>0?-1:1)}r/=i.length,C.moveEnd(t,r,s,e,u,d),k=!1,u+d>4&&w.one("click",function(t){t.preventDefault()})};w.bind(g,T)}n=n||{};var f=n.namespace||"touchslider",l=t(n.container);if(1!==l.length)return void l.each(function(){touchSlider({container:this})});var d=!!navigator.userAgent.match(/AppleWebKit.*Mobile.*/),n=t.extend({autoplay:!1,delay:3e3,margin:5,viewport:"."+f+"-viewport",prev:"."+f+"-prev",next:"."+f+"-next",pagination:"."+f+"-nav-item",currentClass:f+"-nav-item-current",duration:350,heightType:!1,mouseTouch:!0,mobile:d},n),p={current:0,step:o,next:r,prev:a,start:s,stop:c},m="ontouchstart"in window&&"WebKitCSSMatrix"in window,g="touchstart",v="touchmove",b="touchend",w=t(n.viewport,l),M=w.width(),y=n.scroller?t(n.scroller,l):w.children(),x=y.children(),T=t(n.pagination,l);if(T.first().addClass("on"),"absolute"!==y.css("position")){var q=w.children().children().height();n.heightType&&(q=w.height()),w.css({height:q,position:"relative"}),y.css({position:"absolute",left:0,height:q,width:1e5})}m||(g="mousedown",v="mousemove",b="mouseup"),x.css({position:"absolute",width:M});var S=m?function(t,n,i){return n===e?new WebKitCSSMatrix(getComputedStyle(t.jquery?t[0]:t).webkitTransform).e:void t.css({webkitTransitionDuration:i?i+"ms":"0",webkitTransform:function(t){return"translate3d("+("number"==typeof n?n:n.call(this,t))+"px,0,0)"}})}:function(t,n){return n===e?parseInt((t.jquery?t[0]:t).style.left,10):void t.css("left",n)};m&&x.css({webkitTransitionProperty:"-webkit-transform",webkitTransitionTimingFunction:"cubic-bezier(0,0,0.25,1)"}),S(x.not(x[0]),1e4),S(x.eq(0),0);var C=function(){var o=[0],r=[0],a=t.noop;return{moving:!1,init:function(){y.bind("webkitTransitionEnd",function(){a()})},to:function(s,c){c=c||{},s>=x.length?s=0:s<0&&(s=x.length-1);var h=n.duration,f=x.eq(s),l=t.inArray(s,o),d=0;if(y.stop(),C.moving=!0,clearTimeout(W),l!==-1)d=r[l];else{var g,v=x.index(f);if(l=e,c.dirX===-1)r.unshift(0),o.unshift(v);else if(1===c.dirX)r.push(0),o.push(v);else{for(g=o.length-1;g>=0;g--)if(o[g]<v){r.splice(g+1,0,0),o.splice(g+1,0,v),l=0;break}l===e&&(r.unshift(r),o.unshift(v))}if(l=t.inArray(v,o),0===l)d=r[1]-(f.outerWidth()+n.margin),S(f,d),r[l]=d;else if(l===o.length-1)d=r[l-1]+x.eq(o[l-1]).outerWidth()+n.margin,S(f,d),r[l]=d;else{var b=f.outerWidth();f.css("opacity",0),d=r[l+1]-Math.round((b+n.margin)/2),r[l]=d,S(f,d);var w=d,M=o.length;for(g=l-1;g>=0;g--)w-=x.eq(o[g]).outerWidth()+n.margin,r[g]=w;var T=d;for(g=l+1;g<M;g++)T+=x.eq(o[g]).outerWidth()+n.margin,r[g]=T;for(g=0;g<M;g++)x.eq(o[g]).animate({left:r[g]},{duration:h,queue:!1,complete:function(){f.is(this)&&f.animate({opacity:1},h)}})}}c.pxInMs&&(h=Math.min(Math.max(Math.round(Math.abs(S(y))/c.pxInMs),100),h)),a=function(){S(x.not(f),-1e4),o=[x.index(f)],r=[d],c.complete&&c.complete(),C.moving=!1,u()},m?S(y,-d,h):y.animate({left:-d},{duration:h,queue:!1,complete:a}),p.current=s,i(s)},stop:function(){m?S(y,S(y)):y.stop()},moveStart:function(t){C.moving=!0,clearTimeout(W),y.stop(),C.startPageX=t.pageX;var e,n=S(y);C.leftCount=n,0===o[0]?r[0]+n>0&&(C.leftCount=n+3*(r[0]+n)):o[o.length-1]===x.length-1&&(e=r[o.length-1]+n,e<0&&(C.leftCount=n+3*e))},move:function(t,e){var i,a,u,s=t.pageX-e,c=S(y),h=x.eq(o[0]),f=o.length-1,l=x.eq(o[f]);if(C.leftCount+=s,s>0)for(;0!==o[0]&&c+r[0]+s>n.margin;)i=x.eq(o[0]-1),a=r[0]-i.outerWidth()-n.margin,S(i,a),r.unshift(a),o.unshift(o[0]-1),f++,h=i;if((s>0&&c+r[0]+s>0||s<0&&c+r[0]>0)&&0===o[0]&&(u=Math.min(Math.round((C.leftCount+r[0])/4),w.innerWidth()/2),s=u-(c+r[0])),s<0)for(;!l.is(x.last())&&c+r[f]+s+l.outerWidth()+n.margin<w.innerWidth();)i=x.eq(o[f]+1),a=r[f]+l.outerWidth()+n.margin,S(i,a),r.push(a),o.push(o[f++]+1),l=i;(s>0&&c+r[f]<0||s<0&&c+r[f]+s<0)&&l.is(x.last())&&(u=Math.max(Math.round((C.leftCount+r[f])/4),-w.innerWidth()/2),s=u-(c+r[f])),S(y,c+s)},moveEnd:function(t,e,n,i,a,u){var s,c=o.length,h=S(y),f=c-1;if(r[0]+h>0)f=0;else if(r[o.length-1]+h<0);else{s={pxInMs:e};var l,d,p=c-1,m=w.innerWidth();for(l=0;l<c-1;l++)if(d=r[l]+x.eq(o[l]).outerWidth()+h,d>0&&d>m-(r[l+1]+h)){p=l;break}if(k)f=p;else{var g=c-1,v=Math.round(y.offset().left);for(l=0;l<c;l++)if(r[l]+v>t.pageX){g=l-1;break}f=p,p===g&&t.timeStamp-i<1e3&&a+u>.05*Math.sqrt(Math.pow(w.height(),2)+Math.pow(m,2))&&(f=Math.max(0,Math.min(c-1,f+n)))}}f=o[f],C.to(f,s)}}}();if(C.init(),m){var k=!1;y.bind("webkitTransitionStart",function(){k=!0}),y.bind("webkitTransitionEnd",function(){k=!1})}var W,X=!1,E=!1;w.hover(function(){clearTimeout(W),X=!0},function(){X=!1,u()}),T.click(function(){o(T.index(this))}),t(n.prev,l).click(function(){a()}),t(n.next,l).click(function(){r()}),n.mouseTouch&&d&&h(),n.autoplay&&s(),l.data(f,p)},t.fn.touchSlider=function(t){return t=t||{},t.container=this,touchSlider(t),this}});