!function(t){"function"==typeof define&&define.amd&&define(["jquery"],t),"function"==typeof define?define(["jquery"],function(){return t(window.jQuery,void 0)}):t(window.jQuery||window.Zepto)}(function($,t){window.touchSlider=function(e){function n(t){x.removeClass(e.currentClass).eq(t).addClass(e.currentClass)}function i(e,n){var i=d.current;i!==e&&(e=e!==t?e:i+1,S.to(e,{complete:n}))}function o(t){S.to(d.current+1,{dirX:1,complete:t})}function r(t){S.to(d.current-1,{dirX:-1,complete:t})}function a(){X&&u()}function u(){return X=!0,W||(clearTimeout(k),k=setTimeout(function(){S.moving||W||o()},e.delay)),e.container}function s(){return clearTimeout(k),X=!1,e.container}function c(){var t,e,n,i,o,r,a,u,s,c,f,l,d,w=$(document),y=!1,x=function(u){if(!(u.which>1)){if(y&&w.triggerHandler(v+"."+h),y=!0,e=!1,t=u.timeStamp,a=l=0,n=[0,0,0,t],u.originalEvent.touches)return void w.one(m,T);u.preventDefault(),o=r=u.pageX,c=f=u.pageY,s=M[0].offsetLeft,i=[0,0,0,o],w.bind(g,q),w.one(v+"."+h,k),S.moveStart(u)}},T=function(t){1===t.originalEvent.touches.length&&(o=r=t.pageX=t.originalEvent.touches[0].pageX,c=f=t.pageY=t.originalEvent.touches[0].pageY,u=d=0,s=new WebKitCSSMatrix(window.getComputedStyle(M[0]).webkitTransform).e,i=[0,0,0,o],w.bind(g,q),w.one(v,k),S.moveStart(t))},q=function(t){var o,s;if(t.originalEvent.touches&&p){if(1!==t.originalEvent.touches.length)return;if(o=t.pageX=t.originalEvent.touches[0].pageX,s=t.pageY=t.originalEvent.touches[0].pageY,u+=Math.abs(o-r),d+=Math.abs(s-f),Math.abs(u-d)>50){var c=u;u=Math.min(100,Math.max(0,u-d)),d=Math.min(100,Math.max(0,d-c))}if(o===r)return;e||(u>d?(t.preventDefault(),e=!0):k(t))}else{if(o=t.pageX,s=t.pageY,o===r)return;/msie/.test(navigator.userAgent.toLowerCase())&&t.preventDefault()}a+=Math.abs(o-r),l+=Math.abs(s-f),n.shift(),n.push(t.timeStamp),i.shift(),i.push(o),S.move(t,r),r=o,f=s},k=function(e){y=!1,e.originalEvent&&!e.originalEvent.touches||(e.pageX=r,e.pageY=f),w.unbind(g,q);for(var o=n.length,u=0,s=0;--o>0;)if(n[o-1]){var c=i[o]-i[o-1];u+=Math.abs(c)/(n[o]-n[o-1]),0!==c&&(s=c>0?-1:1)}u/=n.length,S.moveEnd(e,u,s,t,a,l),C=!1,a+l>4&&b.one("click",function(t){t.preventDefault()})};b.bind(m,x)}e=e||{};var h=e.namespace||"touchslider",f=$(e.container);if(1!==f.length)return void f.each(function(){touchSlider({container:this})});var l=!!navigator.userAgent.match(/AppleWebKit.*Mobile.*/),e=$.extend({autoplay:!1,delay:3e3,margin:5,viewport:"."+h+"-viewport",prev:"."+h+"-prev",next:"."+h+"-next",pagination:"."+h+"-nav-item",currentClass:h+"-nav-item-current",duration:350,heightType:!1,mouseTouch:!0,mobile:l},e),d={current:0,step:i,next:o,prev:r,start:u,stop:s},p="ontouchstart"in window&&"WebKitCSSMatrix"in window,m="touchstart",g="touchmove",v="touchend",b=$(e.viewport,f),w=b.width(),M=e.scroller?$(e.scroller,f):b.children(),y=M.children(),x=$(e.pagination,f);if(x.first().addClass("on"),"absolute"!==M.css("position")){var T=b.children().children().height();e.heightType&&(T=b.height()),b.css({height:T,position:"relative"}),M.css({position:"absolute",left:0,height:T,width:1e5})}p||(m="mousedown",g="mousemove",v="mouseup"),y.css({position:"absolute",width:w});var q=p?function(e,n,i){return n===t?new WebKitCSSMatrix(getComputedStyle(e.jquery?e[0]:e).webkitTransform).e:void e.css({webkitTransitionDuration:i?i+"ms":"0",webkitTransform:function(t){return"translate3d("+("number"==typeof n?n:n.call(this,t))+"px,0,0)"}})}:function(e,n){return n===t?parseInt((e.jquery?e[0]:e).style.left,10):void e.css("left",n)};p&&y.css({webkitTransitionProperty:"-webkit-transform",webkitTransitionTimingFunction:"cubic-bezier(0,0,0.25,1)"}),q(y.not(y[0]),1e4),q(y.eq(0),0);var S=function(){var i=[0],o=[0],r=$.noop;return{moving:!1,init:function(){M.bind("webkitTransitionEnd",function(){r()})},to:function(u,s){s=s||{},u>=y.length?u=0:0>u&&(u=y.length-1);var c=e.duration,h=y.eq(u),f=$.inArray(u,i),l=0;if(M.stop(),S.moving=!0,clearTimeout(k),-1!==f)l=o[f];else{var m,g=y.index(h);if(f=t,-1===s.dirX)o.unshift(0),i.unshift(g);else if(1===s.dirX)o.push(0),i.push(g);else{for(m=i.length-1;m>=0;m--)if(i[m]<g){o.splice(m+1,0,0),i.splice(m+1,0,g),f=0;break}f===t&&(o.unshift(o),i.unshift(g))}if(f=$.inArray(g,i),0===f)l=o[1]-(h.outerWidth()+e.margin),q(h,l),o[f]=l;else if(f===i.length-1)l=o[f-1]+y.eq(i[f-1]).outerWidth()+e.margin,q(h,l),o[f]=l;else{var v=h.outerWidth();h.css("opacity",0),l=o[f+1]-Math.round((v+e.margin)/2),o[f]=l,q(h,l);var b=l,w=i.length;for(m=f-1;m>=0;m--)b-=y.eq(i[m]).outerWidth()+e.margin,o[m]=b;var x=l;for(m=f+1;w>m;m++)x+=y.eq(i[m]).outerWidth()+e.margin,o[m]=x;for(m=0;w>m;m++)y.eq(i[m]).animate({left:o[m]},{duration:c,queue:!1,complete:function(){h.is(this)&&h.animate({opacity:1},c)}})}}s.pxInMs&&(c=Math.min(Math.max(Math.round(Math.abs(q(M))/s.pxInMs),100),c)),r=function(){q(y.not(h),-1e4),i=[y.index(h)],o=[l],s.complete&&s.complete(),S.moving=!1,a()},p?q(M,-l,c):M.animate({left:-l},{duration:c,queue:!1,complete:r}),d.current=u,n(u)},stop:function(){p?q(M,q(M)):M.stop()},moveStart:function(t){S.moving=!0,clearTimeout(k),M.stop(),S.startPageX=t.pageX;var e,n=q(M);S.leftCount=n,0===i[0]?o[0]+n>0&&(S.leftCount=n+3*(o[0]+n)):i[i.length-1]===y.length-1&&(e=o[i.length-1]+n,0>e&&(S.leftCount=n+3*e))},move:function(t,n){var r,a,u,s=t.pageX-n,c=q(M),h=y.eq(i[0]),f=i.length-1,l=y.eq(i[f]);if(S.leftCount+=s,s>0)for(;0!==i[0]&&c+o[0]+s>e.margin;)r=y.eq(i[0]-1),a=o[0]-r.outerWidth()-e.margin,q(r,a),o.unshift(a),i.unshift(i[0]-1),f++,h=r;if((s>0&&c+o[0]+s>0||0>s&&c+o[0]>0)&&0===i[0]&&(u=Math.min(Math.round((S.leftCount+o[0])/4),b.innerWidth()/2),s=u-(c+o[0])),0>s)for(;!l.is(y.last())&&c+o[f]+s+l.outerWidth()+e.margin<b.innerWidth();)r=y.eq(i[f]+1),a=o[f]+l.outerWidth()+e.margin,q(r,a),o.push(a),i.push(i[f++]+1),l=r;(s>0&&c+o[f]<0||0>s&&c+o[f]+s<0)&&l.is(y.last())&&(u=Math.max(Math.round((S.leftCount+o[f])/4),-b.innerWidth()/2),s=u-(c+o[f])),q(M,c+s)},moveEnd:function(t,e,n,r,a,u){var s,c=i.length,h=q(M),f=c-1;if(o[0]+h>0)f=0;else if(o[i.length-1]+h<0);else{s={pxInMs:e};var l,d,p=c-1,m=b.innerWidth();for(l=0;c-1>l;l++)if(d=o[l]+y.eq(i[l]).outerWidth()+h,d>0&&d>m-(o[l+1]+h)){p=l;break}if(C)f=p;else{var g=c-1,v=Math.round(M.offset().left);for(l=0;c>l;l++)if(o[l]+v>t.pageX){g=l-1;break}f=p,p===g&&t.timeStamp-r<1e3&&a+u>.05*Math.sqrt(Math.pow(b.height(),2)+Math.pow(m,2))&&(f=Math.max(0,Math.min(c-1,f+n)))}}f=i[f],S.to(f,s)}}}();if(S.init(),p){var C=!1;M.bind("webkitTransitionStart",function(){C=!0}),M.bind("webkitTransitionEnd",function(){C=!1})}var k,W=!1,X=!1;b.hover(function(){clearTimeout(k),W=!0},function(){W=!1,a()}),x.click(function(){i(x.index(this))}),$(e.prev,f).click(function(){r()}),$(e.next,f).click(function(){o()}),e.mouseTouch&&l&&c(),e.autoplay&&u(),f.data(h,d)},$.fn.touchSlider=function(t){return t=t||{},t.container=this,touchSlider(t),this}});