!function(e){"function"==typeof define&&define.amd&&define(["jquery"],e),"function"==typeof define?define(["jquery"],function(){return console.log("CommonJS"),e(jQuery)}):e(window.jQuery||window.Zepto)}(function(e,t){function r(){}function a(e,t){var r;return r=t._$container==s?("innerHeight"in d?d.innerHeight:s.height())+s.scrollTop():t._$container.offset().top+t._$container.height(),r<=e.offset().top-t.threshold}function n(t,r){var a;return a=r._$container==s?s.width()+(e.fn.scrollLeft?s.scrollLeft():d.pageXOffset):r._$container.offset().left+r._$container.width(),a<=t.offset().left-r.threshold}function o(e,t){var r;return r=t._$container==s?s.scrollTop():t._$container.offset().top,r>=e.offset().top+t.threshold+e.height()}function i(t,r){var a;return a=r._$container==s?e.fn.scrollLeft?s.scrollLeft():d.pageXOffset:r._$container.offset().left,a>=t.offset().left+r.threshold+t.width()}function l(e,t){var r=0;e.each(function(l,c){function f(){_.trigger("_lazyload_appear"),r=0}var _=e.eq(l);if(!(_.width()<=0&&_.height()<=0||"none"===_.css("display")))if(t.vertical_only)if(o(_,t));else if(a(_,t)){if(++r>t.failure_limit)return!1}else f();else if(o(_,t)||i(_,t));else if(a(_,t)||n(_,t)){if(++r>t.failure_limit)return!1}else f()})}function c(e){return e.filter(function(t,r){return!e.eq(t)._lazyload_loadStarted})}function f(e,t){function r(){i=0,l=+new Date,o=e.apply(a,n),a=null,n=null}var a,n,o,i,l=0;return function(){a=this,n=arguments;var e=new Date-l;return i||(e>=t?r():i=setTimeout(r,t-e)),o}}var _,d=window,s=e(d),u={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:d,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:r,load:r,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:r,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};_=function(){var e=Object.prototype.toString;return function(t){return e.call(t).replace("[object ","").replace("]","")}}(),e.fn.hasOwnProperty("lazyload")||(e.fn.lazyload=function(t){var a,n,o,i=this;return e.isPlainObject(t)||(t={}),e.each(u,function(r,a){e.inArray(r,["threshold","failure_limit","check_appear_throttle_time"])!=-1?"String"==_(t[r])?t[r]=parseInt(t[r],10):t[r]=a:"container"==r?(t.hasOwnProperty(r)?t[r]==d||t[r]==document?t._$container=s:t._$container=e(t[r]):t._$container=s,delete t.container):!u.hasOwnProperty(r)||t.hasOwnProperty(r)&&_(t[r])==_(u[r])||(t[r]=a)}),a="scroll"==t.event,o=0==t.check_appear_throttle_time?l:f(l,t.check_appear_throttle_time),n=a||"scrollstart"==t.event||"scrollstop"==t.event,i.each(function(a,o){var l=this,f=i.eq(a),_=f.attr("src"),d=f.attr("data-"+t.data_attribute),s=t.url_rewriter_fn==r?d:t.url_rewriter_fn.call(l,f,d),u=f.attr("data-"+t.data_srcset_attribute),h=f.is("img");return 1==f._lazyload_loadStarted||_==s?(f._lazyload_loadStarted=!0,void(i=c(i))):(f._lazyload_loadStarted=!1,h&&!_&&f.one("error",function(){f.attr("src",t.placeholder_real_img)}).attr("src",t.placeholder_data_img),f.one("_lazyload_appear",function(){function a(){n&&f.hide(),h?(u&&f.attr("srcset",u),s&&f.attr("src",s)):f.css("background-image",'url("'+s+'")'),n&&f[t.effect].apply(f,o?t.effect_params:[]),i=c(i)}var n,o=e.isArray(t.effect_params);f._lazyload_loadStarted||(n="show"!=t.effect&&e.fn[t.effect]&&(!t.effect_params||o&&0==t.effect_params.length),t.appear!=r&&t.appear.call(l,f,i.length,t),f._lazyload_loadStarted=!0,t.no_fake_img_loader||u?(t.load!=r&&f.one("load",function(){t.load.call(l,f,i.length,t)}),a()):e("<img />").one("load",function(){a(),t.load!=r&&t.load.call(l,f,i.length,t)}).attr("src",s))}),void(n||f.on(t.event,function(){f._lazyload_loadStarted||f.trigger("_lazyload_appear")})))}),n&&t._$container.on(t.event,function(){o(i,t)}),s.on("resize load",function(){o(i,t)}),e(function(){o(i,t)}),this})});