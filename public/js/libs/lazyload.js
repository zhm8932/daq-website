!function(e){"function"==typeof define&&define.amd&&define(["jquery"],e),"function"==typeof define?define(["jquery"],function(){return console.log("CommonJS"),e(jQuery)}):e(window.jQuery||window.Zepto)}(function($,e){function t(){}function r(e,t){var r;return r=t._$container==d?("innerHeight"in _?_.innerHeight:d.height())+d.scrollTop():t._$container.offset().top+t._$container.height(),r<=e.offset().top-t.threshold}function a(e,t){var r;return r=t._$container==d?d.width()+($.fn.scrollLeft?d.scrollLeft():_.pageXOffset):t._$container.offset().left+t._$container.width(),r<=e.offset().left-t.threshold}function n(e,t){var r;return r=t._$container==d?d.scrollTop():t._$container.offset().top,r>=e.offset().top+t.threshold+e.height()}function o(e,t){var r;return r=t._$container==d?$.fn.scrollLeft?d.scrollLeft():_.pageXOffset:t._$container.offset().left,r>=e.offset().left+t.threshold+e.width()}function i(e,t){var i=0;e.each(function(l,c){function f(){_.trigger("_lazyload_appear"),i=0}var _=e.eq(l);if(!(_.width()<=0&&_.height()<=0||"none"===_.css("display")))if(t.vertical_only)if(n(_,t));else if(r(_,t)){if(++i>t.failure_limit)return!1}else f();else if(n(_,t)||o(_,t));else if(r(_,t)||a(_,t)){if(++i>t.failure_limit)return!1}else f()})}function l(e){return e.filter(function(t,r){return!e.eq(t)._lazyload_loadStarted})}function c(e,t){function r(){i=0,l=+new Date,o=e.apply(a,n),a=null,n=null}var a,n,o,i,l=0;return function(){a=this,n=arguments;var e=new Date-l;return i||(e>=t?r():i=setTimeout(r,t-e)),o}}var f,_=window,d=$(_),s={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:_,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:t,load:t,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:t,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};f=function(){var e=Object.prototype.toString;return function(t){return e.call(t).replace("[object ","").replace("]","")}}(),$.fn.hasOwnProperty("lazyload")||($.fn.lazyload=function(e){var r,a,n,o=this;return $.isPlainObject(e)||(e={}),$.each(s,function(t,r){-1!=$.inArray(t,["threshold","failure_limit","check_appear_throttle_time"])?"String"==f(e[t])?e[t]=parseInt(e[t],10):e[t]=r:"container"==t?(e.hasOwnProperty(t)?e[t]==_||e[t]==document?e._$container=d:e._$container=$(e[t]):e._$container=d,delete e.container):!s.hasOwnProperty(t)||e.hasOwnProperty(t)&&f(e[t])==f(s[t])||(e[t]=r)}),r="scroll"==e.event,n=0==e.check_appear_throttle_time?i:c(i,e.check_appear_throttle_time),a=r||"scrollstart"==e.event||"scrollstop"==e.event,o.each(function(r,n){var i=this,c=o.eq(r),f=c.attr("src"),_=c.attr("data-"+e.data_attribute),d=e.url_rewriter_fn==t?_:e.url_rewriter_fn.call(i,c,_),s=c.attr("data-"+e.data_srcset_attribute),u=c.is("img");return 1==c._lazyload_loadStarted||f==d?(c._lazyload_loadStarted=!0,void(o=l(o))):(c._lazyload_loadStarted=!1,u&&!f&&c.one("error",function(){c.attr("src",e.placeholder_real_img)}).attr("src",e.placeholder_data_img),c.one("_lazyload_appear",function(){function r(){a&&c.hide(),u?(s&&c.attr("srcset",s),d&&c.attr("src",d)):c.css("background-image",'url("'+d+'")'),a&&c[e.effect].apply(c,n?e.effect_params:[]),o=l(o)}var a,n=$.isArray(e.effect_params);c._lazyload_loadStarted||(a="show"!=e.effect&&$.fn[e.effect]&&(!e.effect_params||n&&0==e.effect_params.length),e.appear!=t&&e.appear.call(i,c,o.length,e),c._lazyload_loadStarted=!0,e.no_fake_img_loader||s?(e.load!=t&&c.one("load",function(){e.load.call(i,c,o.length,e)}),r()):$("<img />").one("load",function(){r(),e.load!=t&&e.load.call(i,c,o.length,e)}).attr("src",d))}),void(a||c.on(e.event,function(){c._lazyload_loadStarted||c.trigger("_lazyload_appear")})))}),a&&e._$container.on(e.event,function(){n(o,e)}),d.on("resize load",function(){n(o,e)}),$(function(){n(o,e)}),this})});