!function(e){"function"==typeof define&&define.amd&&define(["jquery"],e),"function"==typeof define?define(["jquery"],function(){return e(window.jQuery,window,document,void 0)}):e(window.jQuery||window.Zepto)}(function(e){e.fn.ellipsis=function(t){var i={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return t=e.extend(i,t),this.each(function(){var i=e(this),o=i.text(),l=o,a=l.length,n=i.height();i.text("a");var c=parseFloat(i.css("lineHeight"),10),r=i.height(),h=c>r?c-r:0,f=h*(t.row-1)+r*t.row;if(n<=f)return i.text(o),void t.callback.call(this);var u=1,s=0,d=o.length;if("tail"===t.position){for(;u<d;)s=Math.ceil((u+d)/2),i.text(o.slice(0,s)+t["char"]),i.height()<=f?u=s:d=s-1;o=o.slice(0,u),t.onlyFullWords&&(o=o.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),o+=t["char"]}else if("middle"===t.position){for(var w=0;u<d;)s=Math.ceil((u+d)/2),w=Math.max(a-s,0),i.text(l.slice(0,Math.floor((a-w)/2))+t["char"]+l.slice(Math.floor((a+w)/2),a)),i.height()<=f?u=s:d=s-1;w=Math.max(a-u,0);var p=l.slice(0,Math.floor((a-w)/2)),x=l.slice(Math.floor((a+w)/2),a);t.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),o=p+t["char"]+x}i.text(o),t.callback.call(this)}),this}});