extends ../layout

block content
    link(href='/css/users/user.css',rel='styleSheet')
    include ../includes/responsive
    include ../includes/nav
    .positon.wrapper
        |您的位置为：首页<em>#{sep}</em>我的订单
    section.wrapper.userBox.clearfix
        include ../includes/usersNav
        .box-right.fr
            table.users-table.table-bordered.table
                thead
                    th 订单号
                    th 预约信息
                    th 就诊时间
                    //th 就诊人
                    th 状态
                    th 支付方式
                    th 操作
                tbody
                    if !data.length
                      tr
                        td(colspan='6').tc 暂无挂号

                    else
                    each item in data
                        tr(data-id="#{item.id}")
                            -var hosname = '';
                            each h in item.doctorDTO.hospitalReDepartments
                                -var name = h.hospitalName;
                                -hosname = name.substring(name.indexOf('（')+1,name.indexOf('）')) || name;
                            td
                                p #{item.id}
                                p.text-sec 下单时间:&nbsp;
                                    span #{moment(item.updatedAt).format('YYYY-MM-DD HH:mm:ss')}
                            td
                                if item.doctorDTO
                                    p #{item.doctorDTO.doctorName}&nbsp;#{item.doctorDTO.title}
                                    p.text-sec #{hosname}
                            td
                                p #{moment(item.start).format('YYYY-MM-DD')}
                                p
                                    span.start #{moment(item.start).format('HH:mm:ss')}
                                    |-
                                    span.end #{moment(item.end).format('HH:mm:ss')}
                            mixin payway
                                td
                                    p #{item.payWay}
                                    if item.cost
                                        p #{parseInt(item.cost) / 100}元
                            if item.reservationStatus == 0
                                td.text-stress 未支付
                                +payway
                                td: a(href="javascript:void(0)").cancel-reg 取消
                            else if item.reservationStatus == 1
                                td.text-stress 待就诊
                                +payway
                                td: a(href="javascript:void(0)").cancel-reg 取消
                            else if item.reservationStatus == 2
                                td 已完成
                                +payway
                                td
                            else if item.reservationStatus == 3
                                td.text-sec 已过期
                                +payway
                                td: a(href="javascript:void(0)").del-reg 删除
                            else if item.reservationStatus == 4 || item.reservationStatus == 5 || item.reservationStatus == 6
                                td.text-sec 已取消
                                +payway
                                td: a(href="javascript:void(0)").del-reg 删除
                            //else if item.reservationStatus == 5
                            //    td.text-sec 退款中
                            //    +payway
                            //    td
                            //else if item.reservationStatus == 6
                            //    td.text-sec 已退款
                            //    +payway
                            //    td: a(href="javascript:void(0)").del-reg 删除


    include ../includes/footer
    script.
        seajs.use('/js/users/registerings.js')